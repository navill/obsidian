![](Users/navill/Documents/Obsidian%20Vault/Pasted%20image%2020231212191727.png)
- 비영속 (new/transient)  
	- 영속성 컨텍스트와 전혀 관계가 없는 새로운 상태
- 영속 (managed) 
	- 영속성 컨텍스트에 관리되는 상태
- 준영속 (detached) 
	- 영속성 컨텍스트에 저장되었다가 분리된 상태
- 삭제 (removed) 
	- 삭제된 상태

### 영속성 컨텍스트 이점
- 1차 캐시: 트랜잭션 내에서만 실행되는 캐시(어플리케이션 단위 캐시 - 2차 캐시)
- 동일성 보장
- 트랜잭션을 지원하는 쓰기 지연
- 변경 감지
- 지연 로딩

### 플러시
- 영속성 컨텍스트의 변경내용을 데이터베이스에 반영
	- 변경 감지(dirty checking)
	- 쓰기 지연 SQL 저장소에 등록
	- 쓰기 지연 SQL(등록, 수정, 삭제) 저장소의 쿼리를 데이터베이스 전송
- 시점
	- em.flush(): 직접 호출
	- 트랜잭션 커밋: 플러시 자동 호출
	- JPQL 쿼리 실행: 플러시 자동 호출

### 준영속 상태
- 시점
	- em.detach(entity): 특정 엔티티를 준영속성 상태로 전환
	- em.clear(): 영속성 컨텍스트 초기화
	- em.close(): 영속성 컨텍스트 종료

#영속성컨텍스트 #flush #detach #persist #clear